name: Deploy Frontend to Emergent.host

on:
  push:
    branches: [main]
    paths:
      - 'frontend/**'
      - '.github/workflows/deploy-frontend.yml'
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      
      - name: Deploy to Emergent.host
        run: |
          echo "🚀 Triggering frontend deployment..."
          echo "Frontend deploys automatically via Emergent.host integration"
          echo "Changes will be live within 2-3 minutes"
      
      - name: Notify completion
        run: |
          echo "✅ Frontend deployment triggered successfully"
          echo "🌐 URL: https://fidus-invest.emergent.host"
          echo "📊 Check deployment status in Emergent dashboard"
      
      - name: Wait for build
        run: |
          echo "⏳ Waiting 90 seconds for build to complete..."
          sleep 90
      
      - name: Verify deployment
        run: |
          echo "🔍 Verifying frontend is accessible..."
          response=$(curl -s -o /dev/null -w "%{http_code}" https://fidus-invest.emergent.host)
          if [ $response -eq 200 ]; then
            echo "✅ Frontend deployment successful!"
          else
            echo "⚠️ Frontend may still be building (HTTP $response)"
            echo "Check status at: https://fidus-invest.emergent.host"
          fi
